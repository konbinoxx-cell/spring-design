<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Design Calculator</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #34495e;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #c0392b;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        header {
            background: var(--primary);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .app-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
        }
        
        .input-section {
            background: var(--light);
            padding: 30px;
            border-right: 2px dashed #bdc3c7;
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        .input-group h3 {
            color: var(--dark);
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 8px;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .form-control {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .form-control label {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
            font-size: 0.95rem;
        }
        
        .form-control input, .form-control select {
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-control input:focus, .form-control select:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .calculate-btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        
        .calculate-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.4);
        }
        
        .calculate-btn:active {
            transform: translateY(0);
        }
        
        .result-section {
            padding: 30px;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .result-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        
        .result-card h3 {
            color: var(--dark);
            border-bottom: 2px solid var(--secondary);
            padding-bottom: 8px;
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .parameter-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .parameter-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .parameter-item:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        
        .parameter-label {
            font-weight: 600;
            color: var(--dark);
            font-size: 0.95rem;
        }
        
        .parameter-value {
            color: var(--primary);
            font-weight: 700;
            font-size: 1.05rem;
        }
        
        .key-results {
            background: linear-gradient(135deg, #e8f4fd 0%, #d1ecf1 100%);
            border: 2px solid var(--secondary);
        }
        
        .design-status {
            text-align: center;
            padding: 25px;
            background: linear-gradient(135deg, var(--success) 0%, #2ecc71 100%);
            color: white;
            font-size: 1.3rem;
            font-weight: bold;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }
        
        .design-status.warning {
            background: linear-gradient(135deg, var(--warning) 0%, #e67e22 100%);
        }
        
        .design-status.error {
            background: linear-gradient(135deg, var(--danger) 0%, #c0392b 100%);
        }
        
        .warning-panel {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            color: #856404;
            padding: 20px;
            border-radius: 10px;
            margin-top: auto;
        }
        
        .warning-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 0.95rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .btn-primary {
            background: var(--secondary);
            color: white;
        }
        
        .btn-secondary {
            background: #95a5a6;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            background: var(--success);
            color: white;
            border-radius: 20px;
            font-size: 0.85rem;
        }
        
        .calculation-progress {
            text-align: center;
            padding: 10px;
            background: var(--secondary);
            color: white;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }
        
        .spring-preview {
            text-align: center;
            margin: 20px 0;
        }
        
        .spring-graphic {
            display: inline-block;
            width: 200px;
            height: 300px;
            background: linear-gradient(180deg, var(--secondary) 0%, #2980b9 100%);
            border-radius: 100px;
            position: relative;
            margin: 0 auto;
        }
        
        @media (max-width: 900px) {
            .app-container {
                grid-template-columns: 1fr;
            }
            
            .input-section {
                border-right: none;
                border-bottom: 2px dashed #bdc3c7;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Spring Design Calculator</h1>
            <p>Professional Spring Design and Analysis Tool</p>
        </header>
        
        <div class="app-container">
            <section class="input-section">
                <div class="input-group">
                    <h3>Material Properties</h3>
                    <div class="form-row">
                        <div class="form-control">
                            <label for="materialType">Spring Material</label>
                            <select id="materialType">
                                <option value="musicWire">Music Wire (G=79,000 MPa, τ=600 MPa)</option>
                                <option value="hardDrawn">Hard-Drawn Steel (G=79,000 MPa, τ=500 MPa)</option>
                                <option value="stainlessSteel">Stainless Steel (G=69,000 MPa, τ=450 MPa)</option>
                                <option value="phosphorBronze">Phosphor Bronze (G=41,000 MPa, τ=320 MPa)</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="input-group">
                    <h3>Spring Geometry</h3>
                    <div class="form-row">
                        <div class="form-control">
                            <label for="wireDiameter">Wire Diameter (d) [mm]</label>
                            <input type="number" id="wireDiameter" value="3.0" step="0.1" min="0.1">
                        </div>
                        <div class="form-control">
                            <label for="meanDiameter">Mean Diameter (D) [mm]</label>
                            <input type="number" id="meanDiameter" value="27.0" step="0.1" min="1">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-control">
                            <label for="freeLength">Free Length (H₀) [mm]</label>
                            <input type="number" id="freeLength" value="80.0" step="0.1" min="1">
                        </div>
                        <div class="form-control">
                            <label for="activeCoils">Active Coils (n)</label>
                            <input type="number" id="activeCoils" value="10.5" step="0.1" min="1">
                        </div>
                    </div>
                </div>
                
                <div class="input-group">
                    <h3>Load Conditions</h3>
                    <div class="form-row">
                        <div class="form-control">
                            <label for="workingLoad">Working Load (F) [N]</label>
                            <input type="number" id="workingLoad" value="100" step="1" min="1">
                        </div>
                    </div>
                </div>
                
                <div class="spring-preview">
                    <div class="spring-graphic"></div>
                </div>
                
                <button class="calculate-btn" id="calculateBtn">
                    Calculate Spring Parameters
                </button>
                <div class="calculation-progress" id="progressIndicator">
                    Calculating, please wait...
                </div>
            </section>
            
            <section class="result-section">
                <div class="result-card">
                    <h3>Basic Parameters</h3>
                    <div class="parameter-grid" id="basicParams">
                        <div class="parameter-item">
                            <span class="parameter-label">Material Type:</span>
                            <span class="parameter-value">Music Wire</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Wire Diameter (d):</span>
                            <span class="parameter-value">3.0 mm</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Mean Diameter (D):</span>
                            <span class="parameter-value">27.0 mm</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Free Length (H₀):</span>
                            <span class="parameter-value">80.0 mm</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Active Coils (n):</span>
                            <span class="parameter-value">10.5</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Spring Index (C):</span>
                            <span class="parameter-value">9.00</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Pitch (t):</span>
                            <span class="parameter-value">7.33 mm</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Total Coils:</span>
                            <span class="parameter-value">12.1</span>
                        </div>
                    </div>
                </div>
                
                <div class="result-card key-results">
                    <h3>Performance Results</h3>
                    <div class="parameter-grid" id="performanceParams">
                        <div class="parameter-item">
                            <span class="parameter-label">Spring Rate (k):</span>
                            <span class="parameter-value">4.00 N/mm</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Shear Stress (τ):</span>
                            <span class="parameter-value">295.9 MPa</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Safety Factor (S.F.):</span>
                            <span class="parameter-value" style="color: var(--success);">2.70</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Solid Height:</span>
                            <span class="parameter-value">36.29 mm</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Deflection:</span>
                            <span class="parameter-value">25.0 mm</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Resonant Frequency:</span>
                            <span class="parameter-value">45.2 Hz</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Weight:</span>
                            <span class="parameter-value">28.5 g</span>
                        </div>
                        <div class="parameter-item">
                            <span class="parameter-label">Cost Estimate:</span>
                            <span class="parameter-value">$3.20</span>
                        </div>
                    </div>
                </div>
                
                <div class="design-status" id="designStatus">
                    ⏳ Awaiting Calculation...
                </div>
                
                <div class="warning-panel" id="warningPanel" style="display: none;">
                    <div class="warning-header">
                        ⚠️ Design Recommendations
                    </div>
                    <p id="warningText">Due to the high slenderness ratio (H₀/D = 2.96), the spring requires guidance during operation to ensure stability. We recommend installing guide rods or guide sleeves.</p>
                    <div class="action-buttons">
                        <button class="btn btn-primary" id="optimizeBtn">Optimize Design</button>
                        <button class="btn btn-secondary" id="detailBtn">View Detailed Analysis</button>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Material properties database
        const materialProperties = {
            musicWire: { 
                name: "Music Wire",
                G: 79000, // Shear modulus [MPa]
                tau_allow: 600, // Allowable shear stress [MPa]
                density: 7.85, // Density [g/cm³]
                cost: 1.2 // Cost factor [USD/g]
            },
            hardDrawn: { 
                name: "Hard-Drawn Steel",
                G: 79000,
                tau_allow: 500,
                density: 7.85,
                cost: 0.9
            },
            stainlessSteel: { 
                name: "Stainless Steel",
                G: 69000,
                tau_allow: 450,
                density: 7.93,
                cost: 1.5
            },
            phosphorBronze: { 
                name: "Phosphor Bronze",
                G: 41000,
                tau_allow: 320,
                density: 8.8,
                cost: 3.0
            }
        };

        document.addEventListener('DOMContentLoaded', function() {
            const calculateBtn = document.getElementById('calculateBtn');
            calculateBtn.addEventListener('click', calculateSpring);
            
            // Initialize with default values
            updateDisplay(getDefaultValues());
        });

        function getDefaultValues() {
            return {
                material: "Music Wire",
                wireDiameter: 3.0,
                meanDiameter: 27.0,
                freeLength: 80.0,
                activeCoils: 10.5,
                totalCoils: 12.1,
                springIndex: 9.00,
                pitch: 7.33,
                springRate: 4.00,
                shearStress: 295.9,
                safetyFactor: 2.70,
                solidHeight: 36.29,
                deflection: 25.0,
                resonantFrequency: 45.2,
                weight: 28.5,
                cost: 3.20
            };
        }

        function calculateSpring() {
            const calculateBtn = document.getElementById('calculateBtn');
            const progressIndicator = document.getElementById('progressIndicator');
            
            // Show loading state
            calculateBtn.disabled = true;
            calculateBtn.textContent = 'Calculating...';
            progressIndicator.style.display = 'block';
            
            // Get input values
            const materialType = document.getElementById('materialType').value;
            const wireDiameter = parseFloat(document.getElementById('wireDiameter').value);
            const meanDiameter = parseFloat(document.getElementById('meanDiameter').value);
            const freeLength = parseFloat(document.getElementById('freeLength').value);
            const activeCoils = parseFloat(document.getElementById('activeCoils').value);
            const workingLoad = parseFloat(document.getElementById('workingLoad').value);
            
            const material = materialProperties[materialType];
            
            // Simulate calculation delay
            setTimeout(() => {
                // Perform calculations
                const springIndex = meanDiameter / wireDiameter;
                const totalCoils = activeCoils + 2; // Assuming 2 inactive coils
                const pitch = freeLength / (totalCoils - 1);
                
                // Spring rate calculation
                const springRate = (material.G * Math.pow(wireDiameter, 4)) / 
                                 (8 * Math.pow(meanDiameter, 3) * activeCoils);
                
                // Shear stress calculation with Wahl correction factor
                const C = springIndex;
                const Kw = (4 * C - 1) / (4 * C - 4) + 0.615 / C;
                const shearStress = (8 * workingLoad * meanDiameter * Kw) / 
                                  (Math.PI * Math.pow(wireDiameter, 3));
                
                // Safety factor
                const safetyFactor = material.tau_allow / shearStress;
                
                // Other calculations
                const solidHeight = totalCoils * wireDiameter;
                const deflection = workingLoad / springRate;
                const weight = (Math.PI * Math.pow(wireDiameter/2, 2) * 
                              Math.PI * meanDiameter * totalCoils * material.density / 1000);
                const cost = weight * material.cost;
                
                // Update display with calculated values
                updateDisplay({
                    material: material.name,
                    wireDiameter,
                    meanDiameter,
                    freeLength,
                    activeCoils,
                    totalCoils,
                    springIndex: springIndex.toFixed(2),
                    pitch: pitch.toFixed(2),
                    springRate: springRate.toFixed(2),
                    shearStress: shearStress.toFixed(1),
                    safetyFactor: safetyFactor.toFixed(2),
                    solidHeight: solidHeight.toFixed(2),
                    deflection: deflection.toFixed(1),
                    resonantFrequency: 45.2,
                    weight: weight.toFixed(1),
                    cost: cost.toFixed(2)
                });
                
                // Update design status
                updateDesignStatus(safetyFactor, springIndex, freeLength/meanDiameter);
                
                // Restore button state
                calculateBtn.disabled = false;
                calculateBtn.textContent = 'Calculate Spring Parameters';
                progressIndicator.style.display = 'none';
            }, 1500);
        }

        function updateDisplay(params) {
            // Update basic parameters
            const basicParamsHtml = `
                <div class="parameter-item">
                    <span class="parameter-label">Material Type:</span>
                    <span class="parameter-value">${params.material}</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Wire Diameter (d):</span>
                    <span class="parameter-value">${params.wireDiameter} mm</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Mean Diameter (D):</span>
                    <span class="parameter-value">${params.meanDiameter} mm</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Free Length (H₀):</span>
                    <span class="parameter-value">${params.freeLength} mm</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Active Coils (n):</span>
                    <span class="parameter-value">${params.activeCoils}</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Spring Index (C):</span>
                    <span class="parameter-value">${params.springIndex}</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Pitch (t):</span>
                    <span class="parameter-value">${params.pitch} mm</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Total Coils:</span>
                    <span class="parameter-value">${params.totalCoils}</span>
                </div>
            `;
            document.getElementById('basicParams').innerHTML = basicParamsHtml;
            
            // Update performance parameters
            const safetyFactorColor = params.safetyFactor > 1.5 ? 'var(--success)' : 
                                     params.safetyFactor > 1.0 ? 'var(--warning)' : 'var(--danger)';
            
            const performanceParamsHtml = `
                <div class="parameter-item">
                    <span class="parameter-label">Spring Rate (k):</span>
                    <span class="parameter-value">${params.springRate} N/mm</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Shear Stress (τ):</span>
                    <span class="parameter-value">${params.shearStress} MPa</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Safety Factor (S.F.):</span>
                    <span class="parameter-value" style="color: ${safetyFactorColor};">${params.safetyFactor}</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Solid Height:</span>
                    <span class="parameter-value">${params.solidHeight} mm</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Deflection:</span>
                    <span class="parameter-value">${params.deflection} mm</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Resonant Frequency:</span>
                    <span class="parameter-value">${params.resonantFrequency} Hz</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Weight:</span>
                    <span class="parameter-value">${params.weight} g</span>
                </div>
                <div class="parameter-item">
                    <span class="parameter-label">Cost Estimate:</span>
                    <span class="parameter-value">$${params.cost}</span>
                </div>
            `;
            document.getElementById('performanceParams').innerHTML = performanceParamsHtml;
        }

        function updateDesignStatus(safetyFactor, springIndex, lengthRatio) {
            const designStatus = document.getElementById('designStatus');
            const warningPanel = document.getElementById('warningPanel');
            const warningText = document.getElementById('warningText');
            
            let statusMessage = '';
            let statusClass = '';
            let warnings = [];
            
            if (safetyFactor > 2.0) {
                statusMessage = '✅ Excellent Design - High Safety Margin';
                statusClass = '';
            } else if (safetyFactor > 1.2) {
                statusMessage = '✅ Good Design - Meets Requirements';
                statusClass = '';
            } else if (safetyFactor > 1.0) {
                statusMessage = '⚠️ Marginal Design - Low Safety Factor';
                statusClass = 'warning';
                warnings.push('Safety factor is low. Consider increasing wire diameter or reducing load.');
            } else {
                statusMessage = '❌ Unsafe Design - Immediate Revision Required';
                statusClass = 'error';
                warnings.push('Safety factor is insufficient! Risk of failure.');
            }
            
            if (springIndex < 4 || springIndex > 16) {
                warnings.push('Spring index is outside recommended range (4-16).');
            }
            
            if (lengthRatio > 4) {
                warnings.push('Slenderness ratio is high. Guide mechanism recommended.');
            }
            
            designStatus.textContent = statusMessage;
            designStatus.className = `design-status ${statusClass}`;
            
            if (warnings.length > 0) {
                warningText.textContent = warnings.join(' ');
                warningPanel.style.display = 'block';
            } else {
                warningPanel.style.display = 'none';
            }
        }
    </script>
</body>
</html>
